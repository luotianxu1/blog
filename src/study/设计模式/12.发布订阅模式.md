---
title: 发布订阅模式
icon: 设计模式
order: 12
date: 2024-05-31
category:
    - 设计模式
tag:
    - 发布订阅模式
---


```js
const PubSub = {
    message: {},
    publish(type) {
        if (!this.message[type]) return
        this.message[type].forEach((item) => item())
    },
    subscribe(type, cb) {
        if (!this.message[type]) {
            this.message[type] = [cb]
        } else {
            this.message[type].push(cb)
        }
    },
    unsubscribe(type, cb) {
        if (!this.message[type]) return
        if (!cb) {
            this.message[type] && (this.message[type].length = 0)
        } else {
            this.message[type] = this.message[type].filter(
                (item) => item !== cb
            )
        }
    },
}

function testA() {
    console.log('testA')
}

function testB() {
    console.log('testB')
}

function testC() {
    console.log('testC')
}

PubSub.subscribe('A', testA)
PubSub.subscribe('A', testC)
PubSub.subscribe('B', testB)

PubSub.publish('A')
PubSub.publish('B')

```
