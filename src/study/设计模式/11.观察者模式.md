---
title: 观察者模式
icon: 设计模式
order: 11
date: 2024-05-31
category:
    - 设计模式
tag:
    - 观察者模式
---

- 观察者模式包含观察目标和观察者两类对象，一个目标可以有任意数目的与之相依赖的观察者，一旦观察目标的状态发生改变，所有的观察者都将得到通知。

当一个对象的状态发生改变是，所有依赖于它的对象都得到通知并被自动更细你，解决了主体对象与观察者之间功能的耦合，即一个对象状态该表给其他对象通知的问题

```js
class Subject {
    constructor() {
        this.observers = []
    }

    add(observer) {
        this.observers.push(observer)
    }

    remove(observer) {
        this.observers = this.observers.filter((item) => item !== observer)
    }

    notify() {
        this.observers.forEach((item) => {
            item.update()
        })
    }
}

class Observer {
    constructor(name) {
        this.name = name
    }
    update() {
        console.log('update', this.name)
    }
}

const subject = new Subject()
const observer1 = new Observer('kerwin')
const observer2 = new Observer('tiechui')

subject.add(observer1)
subject.add(observer2)

setTimeout(() => {
    subject.remove(observer1)
}, 1000)
setTimeout(() => {
    subject.notify()
}, 2000)
```

- 优势
目标者与观察者，功能耦合度降低，专注自身功能逻辑；观察者被动接收更新，时间上解耦，实时接收目标者更新状态。
- 缺点
观察则会模式虽然实现了对象间依赖关系的低耦合，但却不能对事件通知进行细分管控，如“筛选通知”，“指定主题事件通知”
